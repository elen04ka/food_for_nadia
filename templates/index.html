<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–ó º—ó–º —Ç–µ–±–µ –∑–∞ –≥—Ä–æ—à—ñ!</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Comic Sans MS', cursive;
      background-color: #fff0f5;
      text-align: center;
      padding: 40px;
    }
    h1 {
      font-size: 3em;
      color: #e63946;
    }
    input[type="text"] {
      padding: 10px;
      font-size: 1em;
      width: 250px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-bottom: 10px;
    }
    button {
      padding: 10px 20px;
      font-size: 1em;
      background-color: #ff6b6b;
      color: white;
      border: none;
      border-radius: 8px;
      margin-left: 10px;
      cursor: pointer;
    }
    button:hover {
      background-color: #ff4d4d;
    }
    .queue, .eaten {
      margin-top: 30px;
      background: #ffe5ec;
      padding: 20px;
      border-radius: 12px;
      display: inline-block;
      text-align: left;
      margin-right: 20px;
    }
    .admin {
      margin-top: 40px;
      background: #d0f4de;
      padding: 20px;
      border-radius: 12px;
      display: none;
      text-align: center;
    }
    ul {
      list-style-type: none;
      padding: 0;
    }
    li::before {
      content: "üçΩÔ∏è ";
    }
    img {
      max-width: 100%;
      border-radius: 12px;
      margin-top: 30px;
    }

    .nad {
      width: 30%;
      border-radius: 50%;
      margin-top: 30px;
    }

    @media (max-width: 600px) {
      .queue, .eaten {
        display: block;
        margin: 10px auto;
      }
      .nad {
      width: 80%;
      border-radius: 50%;
      margin-top: 30px;
    }
    }
  </style>
</head>
<body>
  <h1>–ó º—ó–º —Ç–µ–±–µ –∑–∞ –≥—Ä–æ—à—ñ!</h1>
  <p>–°—Ç–∞–Ω—å –Ω–∞—Å—Ç—É–ø–Ω–∏–º —É —á–µ—Ä–∑—ñ, –∫–æ–≥–æ —è –∑ º—ó–º! –ó–∞–±—Ä–æ–Ω—é–π —Å–≤–æ—î –º—ñ—Å—Ü–µ –ª–∏—à–µ –∑–∞ 10–≥—Ä–Ω!</p>
  <p>–ü–∏—à–∏ @nad_tum —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ä–µ–∫–≤—ñ–∑–∏—Ç–∏!</p>

  <img class="nad" src="/static/1.jpg" alt="–ù–∞–¥—è" />
  <p><strong>–ó–∞–ø–∏—Å —É —á–µ—Ä–≥—É –π–¥–µ —Å–∞–º–µ –¥–æ —Ü—ñ—î—ó –ø–∞–Ω—ñ ‚¨ÜÔ∏è</strong></p>

  <div>
    <input type="text" id="nameInput" placeholder="–í–≤–µ–¥–∏ —Å–≤–æ—î —ñ–º'—è">
    <br>
    <button onclick="handleInput()">–ó–∞–±—Ä–æ–Ω—é–≤–∞—Ç–∏ —Å–µ–±–µ –Ω–∞ –∑ º—ó–¥–∞–Ω–Ω—è</button>
  </div>

  <div class="queue">
    <h2>–ù–∞—Å—Ç—É–ø–Ω—ñ –≤ —á–µ—Ä–∑—ñ –Ω–∞ –∑ º—ó–¥–∞–Ω–Ω—è:</h2>
    <ul id="eatingQueue"></ul>
  </div>

  <div class="eaten">
    <h2>–ó º—ó–¥–µ–Ω—ñ:</h2>
    <ul id="eatenList"></ul>
  </div>

  <div class="admin" id="adminPanel">
    <h3>–ê–¥–º—ñ–Ω–∫–∞ –¥–ª—è –ù–∞–¥—ñ</h3>
    <select id="selectUser"></select>
    <button onclick="eatUser()">–ó º—ó—Å—Ç–∏</button>
    <button onclick="clearAll()">–û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å–µ</button>
  </div>
  <br>
  <img src="/static/2.png" alt="–ú–µ–º –≥–æ—Ç—É–π—Ç–µ –ø–µ–Ω—Å—ñ—é" />

  <script>
    async function fetchData() {
      const res = await fetch('/api/queue');
      const data = await res.json();
      renderData(data);
    }

    function renderData(data) {
      const queueList = document.getElementById('eatingQueue');
      const eatenList = document.getElementById('eatenList');
      const selectUser = document.getElementById('selectUser');

      queueList.innerHTML = '';
      selectUser.innerHTML = '';
      eatenList.innerHTML = '';

      data.queue.forEach((name, i) => {
        queueList.innerHTML += `<li>${name}</li>`;
        selectUser.innerHTML += `<option value="${i}">${name}</option>`;
      });

      data.eaten.forEach(name => {
        eatenList.innerHTML += `<li>${name}</li>`;
      });
    }

    async function handleInput() {
      const input = document.getElementById('nameInput');
      const name = input.value.trim();

      if (name.toLowerCase() === 'nadia') {
        document.getElementById('adminPanel').style.display = 'block';
        input.value = '';
        return;
      }

      if (name) {
        await fetch('/api/queue', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({ name })
        });
        input.value = '';
        fetchData();
      }
    }

    async function eatUser() {
      const index = document.getElementById('selectUser').value;
      await fetch('/api/eat', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ index })
      });
      fetchData();
    }

    async function clearAll() {
      await fetch('/api/clear', { method: 'POST' });
      fetchData();
    }

    fetchData();
  </script>
</body>
</html>
